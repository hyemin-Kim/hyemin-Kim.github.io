<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>【실습】 Python &gt;&gt; Classification -- 포켓몬 분류 분석 | Hyemin Kim</title><meta name="keywords" content="Python,sklearn,Machine Learning,분류"><meta name="author" content="Hyemin Kim"><meta name="copyright" content="Hyemin Kim"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="지도학습(Logistic Regression) -- &quot;전설의 포켓몬&quot; 여부 예측;  비지도학습(K-Means Clustering) -- 포켓몬 군집 분석">
<meta property="og:type" content="article">
<meta property="og:title" content="【실습】 Python &gt;&gt; Classification -- 포켓몬 분류 분석">
<meta property="og:url" content="https://hyemin-kim.github.io/2020/08/13/E-Python-Classification-1/index.html">
<meta property="og:site_name" content="Hyemin Kim">
<meta property="og:description" content="지도학습(Logistic Regression) -- &quot;전설의 포켓몬&quot; 여부 예측;  비지도학습(K-Means Clustering) -- 포켓몬 군집 분석">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s1.ax1x.com/2020/08/25/dcPqB9.png">
<meta property="article:published_time" content="2020-08-13T14:00:08.000Z">
<meta property="article:modified_time" content="2020-10-28T06:49:38.772Z">
<meta property="article:author" content="Hyemin Kim">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="sklearn">
<meta property="article:tag" content="Machine Learning">
<meta property="article:tag" content="분류">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s1.ax1x.com/2020/08/25/dcPqB9.png"><link rel="shortcut icon" href="/img/favicon_m.png"><link rel="canonical" href="https://hyemin-kim.github.io/2020/08/13/E-Python-Classification-1/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  hexoversion: '4.2.0',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":false,"highlightLang":true},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":50,"languages":{"author":"Author: Hyemin Kim","link":"Link: ","source":"Source: Hyemin Kim","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source."}},
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2020-10-28 15:49:38'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {
  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }

  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }
})()</script><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Hyemin Kim" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">46</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">Tags</div><div class="length_num">24</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">Categories</div><div class="length_num">10</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div id="body-wrap"><div id="web_bg"></div><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#classification-실습-포켓몬-데이터셋"><span class="toc-text"> 【Classification 실습】 – 포켓몬 데이터셋</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0-개요"><span class="toc-text"> 0. 개요</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-library-data-import"><span class="toc-text"> 1. Library &amp; Data Import</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-eda-exploratoty-data-analysis-탐색적-데이터-분석"><span class="toc-text"> 2. EDA (Exploratoty Data Analysis: 탐색적 데이터 분석)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-데이터셋-기본-정보-탐색"><span class="toc-text"> 2-1. 데이터셋 기본 정보 탐색</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-변수feature-특징-탐색"><span class="toc-text"> 2-2. 변수(Feature) 특징 탐색</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-각-능력치-분포"><span class="toc-text"> (1) 각 능력치 분포</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-총-능력치-total-분포"><span class="toc-text"> (2) 총 능력치 (Total) 분포</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-포켓몬-타입-type-1-type-2-분포"><span class="toc-text"> (3) 포켓몬 타입 (Type 1 &amp; Type 2) 분포</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-포켓몬-세대generation-분포"><span class="toc-text"> (4) 포켓몬 세대(Generation) 분포</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-지도-학습-기반-분류-분석-logistic-regression"><span class="toc-text"> 3. 지도 학습 기반 분류 분석 – Logistic Regression</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-데이터-전처리"><span class="toc-text"> 3-1. 데이터 전처리</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-데이터-타입-변경"><span class="toc-text"> (1) 데이터 타입 변경</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-one-hot-encoding"><span class="toc-text"> (2) One-Hot Encoding</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-feature-포준화"><span class="toc-text"> (3) Feature 포준화</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-training-set-test-set-나누기"><span class="toc-text"> (4) Training set &#x2F; Test set 나누기</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-logistic-regression-모델-학습"><span class="toc-text"> 3-2. Logistic Regression 모델 학습</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-모델-학습"><span class="toc-text"> (1) 모델 학습</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-모델-평가"><span class="toc-text"> (2) 모델 평가</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-클래스-불균형-조정"><span class="toc-text"> 3-3. 클래스 불균형 조정</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-비지도-학습-기반-군집-분석-k-means-clustering"><span class="toc-text"> 4. 비지도 학습 기반 군집 분석 – K-Means Clustering</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-k-means-군집-분석"><span class="toc-text"> 4-1. K-Means 군집 분석</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2차원-군집-분석"><span class="toc-text"> (1) 2차원 군집 분석</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-다차원-군집-분석"><span class="toc-text"> (2) 다차원 군집 분석</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(https://s1.ax1x.com/2020/08/25/dcPqB9.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Hyemin Kim</a></span><span id="menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">【실습】 Python &gt;&gt; Classification -- 포켓몬 분류 분석</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2020-08-13T14:00:08.000Z" title="Created 2020-08-13 23:00:08">2020-08-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2020-10-28T06:49:38.772Z" title="Updated 2020-10-28 15:49:38">2020-10-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E3%80%90EXERCISE%E3%80%91/">【EXERCISE】</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E3%80%90EXERCISE%E3%80%91/Python/">Python</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="classification-실습-포켓몬-데이터셋"><a class="markdownIt-Anchor" href="#classification-실습-포켓몬-데이터셋"></a> 【Classification 실습】 – 포켓몬 데이터셋</h1>
<p></p><ul class="markdownIt-TOC">
<li><a href="#0-%EA%B0%9C%EC%9A%94"><strong>0. 개요</strong></a></li>
<li><a href="#1-library-data-import"><strong>1. Library &amp; Data Import</strong></a></li>
<li><a href="#2-eda-exploratoty-data-analysis-%ED%83%90%EC%83%89%EC%A0%81-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%84%EC%84%9D"><strong>2. EDA (Exploratoty Data Analysis: 탐색적 데이터 분석)</strong></a>
<ul>
<li><a href="#2-1-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B-%EA%B8%B0%EB%B3%B8-%EC%A0%95%EB%B3%B4-%ED%83%90%EC%83%89">2-1. 데이터셋 기본 정보 탐색</a></li>
<li><a href="#2-2-%EB%B3%80%EC%88%98feature-%ED%8A%B9%EC%A7%95-%ED%83%90%EC%83%89">2-2. 변수(Feature) 특징 탐색</a>
<ul>
<li><a href="#1-%EA%B0%81-%EB%8A%A5%EB%A0%A5%EC%B9%98-%EB%B6%84%ED%8F%AC">(1) 각 능력치 분포</a></li>
<li><a href="#2-%EC%B4%9D-%EB%8A%A5%EB%A0%A5%EC%B9%98-total-%EB%B6%84%ED%8F%AC">(2) 총 능력치 (Total) 분포</a></li>
<li><a href="#3-%ED%8F%AC%EC%BC%93%EB%AA%AC-%ED%83%80%EC%9E%85-type-1-type-2-%EB%B6%84%ED%8F%AC">(3) 포켓몬 타입 (Type 1 &amp; Type 2) 분포</a></li>
<li><a href="#4-%ED%8F%AC%EC%BC%93%EB%AA%AC-%EC%84%B8%EB%8C%80generation-%EB%B6%84%ED%8F%AC">(4) 포켓몬 세대(Generation) 분포</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#3-%EC%A7%80%EB%8F%84-%ED%95%99%EC%8A%B5-%EA%B8%B0%EB%B0%98-%EB%B6%84%EB%A5%98-%EB%B6%84%EC%84%9D-logistic-regression"><strong>3. 지도 학습 기반 분류 분석 – Logistic Regression</strong></a>
<ul>
<li><a href="#3-1-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%84%EC%B2%98%EB%A6%AC">3-1. 데이터 전처리</a>
<ul>
<li><a href="#1-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%83%80%EC%9E%85-%EB%B3%80%EA%B2%BD">(1) 데이터 타입 변경</a></li>
<li><a href="#2-one-hot-encoding">(2) One-Hot Encoding</a></li>
<li><a href="#3-feature-%ED%8F%AC%EC%A4%80%ED%99%94">(3) Feature 포준화</a></li>
<li><a href="#4-training-set-test-set-%EB%82%98%EB%88%84%EA%B8%B0">(4) Training set / Test set 나누기</a></li>
</ul>
</li>
<li><a href="#3-2-logistic-regression-%EB%AA%A8%EB%8D%B8-%ED%95%99%EC%8A%B5">3-2. Logistic Regression 모델 학습</a>
<ul>
<li><a href="#1-%EB%AA%A8%EB%8D%B8-%ED%95%99%EC%8A%B5">(1) 모델 학습</a></li>
<li><a href="#2-%EB%AA%A8%EB%8D%B8-%ED%8F%89%EA%B0%80">(2) 모델 평가</a></li>
</ul>
</li>
<li><a href="#3-3-%ED%81%B4%EB%9E%98%EC%8A%A4-%EB%B6%88%EA%B7%A0%ED%98%95-%EC%A1%B0%EC%A0%95">3-3. 클래스 불균형 조정</a></li>
</ul>
</li>
<li><a href="#4-%EB%B9%84%EC%A7%80%EB%8F%84-%ED%95%99%EC%8A%B5-%EA%B8%B0%EB%B0%98-%EA%B5%B0%EC%A7%91-%EB%B6%84%EC%84%9D-k-means-clustering"><strong>4. 비지도 학습 기반 군집 분석 – K-Means Clustering</strong></a>
<ul>
<li><a href="#4-1-k-means-%EA%B5%B0%EC%A7%91-%EB%B6%84%EC%84%9D">4-1. K-Means 군집 분석</a>
<ul>
<li><a href="#1-2%EC%B0%A8%EC%9B%90-%EA%B5%B0%EC%A7%91-%EB%B6%84%EC%84%9D">(1) 2차원 군집 분석</a></li>
<li><a href="#2-%EB%8B%A4%EC%B0%A8%EC%9B%90-%EA%B5%B0%EC%A7%91-%EB%B6%84%EC%84%9D">(2) 다차원 군집 분석</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p></p>
<br>
<h2 id="0-개요"><a class="markdownIt-Anchor" href="#0-개요"></a> <strong>0. 개요</strong></h2>
<p>포켓몬 데이터셋을 이용해 분류 분석을 진행합니다.</p>
<ul>
<li><strong>지도 학습 (Logistic Regression):</strong> “전설의 포켓몬” 여부 예측 – “Legendary” = 0/1</li>
<li><strong>비지도 학습 (K-Means Clustering):</strong> 포켓몬 군집 분석</li>
</ul>
<br>  
<h2 id="1-library-data-import"><a class="markdownIt-Anchor" href="#1-library-data-import"></a> <strong>1. Library &amp; Data Import</strong></h2>
<p><strong>&gt;&gt; 사용할 Library</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line">warnings.filterwarnings(<span class="string">"ignore"</span>)</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plt.rcParams[<span class="string">'font.family'</span>] = <span class="string">'Malgun Gothic'</span>  <span class="comment"># 한글 깨짐 방지</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plt.rcParams[<span class="string">'figure.figsize'</span>] = (<span class="number">10</span>, <span class="number">8</span>)  <span class="comment"># figsize 설정</span></span><br></pre></td></tr></tbody></table></figure>
<br>  
<p><strong>&gt;&gt; 사용할 데이터셋 - Pokemon Dataset</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">"https://raw.githubusercontent.com/yoonkt200/FastCampusDataset/master/Pokemon.csv"</span>)</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.head()</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table>
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>#</th>
      <th>Name</th>
      <th>Type 1</th>
      <th>Type 2</th>
      <th>Total</th>
      <th>HP</th>
      <th>Attack</th>
      <th>Defense</th>
      <th>Sp. Atk</th>
      <th>Sp. Def</th>
      <th>Speed</th>
      <th>Generation</th>
      <th>Legendary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Bulbasaur</td>
      <td>Grass</td>
      <td>Poison</td>
      <td>318</td>
      <td>45</td>
      <td>49</td>
      <td>49</td>
      <td>65</td>
      <td>65</td>
      <td>45</td>
      <td>1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Ivysaur</td>
      <td>Grass</td>
      <td>Poison</td>
      <td>405</td>
      <td>60</td>
      <td>62</td>
      <td>63</td>
      <td>80</td>
      <td>80</td>
      <td>60</td>
      <td>1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Venusaur</td>
      <td>Grass</td>
      <td>Poison</td>
      <td>525</td>
      <td>80</td>
      <td>82</td>
      <td>83</td>
      <td>100</td>
      <td>100</td>
      <td>80</td>
      <td>1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>VenusaurMega Venusaur</td>
      <td>Grass</td>
      <td>Poison</td>
      <td>625</td>
      <td>80</td>
      <td>100</td>
      <td>123</td>
      <td>122</td>
      <td>120</td>
      <td>80</td>
      <td>1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Charmander</td>
      <td>Fire</td>
      <td>NaN</td>
      <td>309</td>
      <td>39</td>
      <td>52</td>
      <td>43</td>
      <td>60</td>
      <td>50</td>
      <td>65</td>
      <td>1</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
<br>
<p><strong>&gt;&gt; Feature Description</strong></p>
<ul>
<li>Name: 포켓몬 이름</li>
<li>Type 1: 포켓몬 타입 1</li>
<li>Type 2: 포켓몬 타입 2</li>
<li>Total: 포켓몬 총 능력치 (Sum of ‘HP’, ‘Attack’, ‘Defense’, ‘Sp.Atk’, ‘Sp.Def’ and ‘Speed’)</li>
<li>HP: 포켓몬 HP 능력치</li>
<li>Attack: 포켓몬 Attack 능력치</li>
<li>Defense: 포켓몬 Defense 능력치</li>
<li>Sp.Atk: 포켓몬 Sp.Atk 능력치</li>
<li>Sp.Def: 포켓몬 Sp.Def 능력치</li>
<li>Speed: 포켓몬 Speed 능력치</li>
<li>Generation: 포켓몬 세대</li>
<li>Legendary: 전설의 포켓몬 여부</li>
</ul>
<p><br>  <br></p>
<h2 id="2-eda-exploratoty-data-analysis-탐색적-데이터-분석"><a class="markdownIt-Anchor" href="#2-eda-exploratoty-data-analysis-탐색적-데이터-분석"></a> <strong>2. EDA (Exploratoty Data Analysis: 탐색적 데이터 분석)</strong></h2>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 그래프 배경 설정</span></span><br><span class="line">sns.set_style(<span class="string">'darkgrid'</span>)</span><br></pre></td></tr></tbody></table></figure>
<h3 id="2-1-데이터셋-기본-정보-탐색"><a class="markdownIt-Anchor" href="#2-1-데이터셋-기본-정보-탐색"></a> 2-1. 데이터셋 기본 정보 탐색</h3>
<p><strong>&gt;&gt; 전체 데이터셋</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># demension</span></span><br><span class="line">df.shape</span><br></pre></td></tr></tbody></table></figure>
<pre><code>(800, 13)
</code></pre>
  <br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># information (data type)</span></span><br><span class="line">df.info()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 800 entries, 0 to 799
Data columns (total 13 columns):
 #   Column      Non-Null Count  Dtype 
---  ------      --------------  ----- 
 0   #           800 non-null    int64 
 1   Name        800 non-null    object
 2   Type 1      800 non-null    object
 3   Type 2      414 non-null    object
 4   Total       800 non-null    int64 
 5   HP          800 non-null    int64 
 6   Attack      800 non-null    int64 
 7   Defense     800 non-null    int64 
 8   Sp. Atk     800 non-null    int64 
 9   Sp. Def     800 non-null    int64 
 10  Speed       800 non-null    int64 
 11  Generation  800 non-null    int64 
 12  Legendary   800 non-null    bool  
dtypes: bool(1), int64(9), object(3)
memory usage: 75.9+ KB
</code></pre>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 결측치</span></span><br><span class="line">df.isnull().sum()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>#               0
Name            0
Type 1          0
Type 2        386
Total           0
HP              0
Attack          0
Defense         0
Sp. Atk         0
Sp. Def         0
Speed           0
Generation      0
Legendary       0
dtype: int64
</code></pre>
  <br>
<p><strong>&gt;&gt; 개별 Feature 탐색</strong></p>
<ul>
<li><strong>분류할 목표 Feature</strong>: “Legendary” (전설의 포켓몬 여부)</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># class 별 데이터 수 확인</span></span><br><span class="line">df[<span class="string">'Legendary'</span>].value_counts()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>False    735
True      65
Name: Legendary, dtype: int64
</code></pre>
 <br> 
<ul>
<li>“Generation” (포켓몬 세대)</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 세대별 데이터 수 확인</span></span><br><span class="line">df[<span class="string">'Generation'</span>].value_counts()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>1    166
5    165
3    160
4    121
2    106
6     82
Name: Generation, dtype: int64
</code></pre>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 세대 순서로 데이터 갯수 시각화</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">8</span>, <span class="number">6</span>))</span><br><span class="line">df[<span class="string">'Generation'</span>].value_counts().sort_index().plot()</span><br><span class="line">plt.title(<span class="string">"'Generation 별 데이터 갯수'"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/images/E-Python-Classification-1/output_34_0.png" alt="output_34_0"></p>
<br>
<ul>
<li>“Type 1” &amp; “Type 2” (포켓몬 타입)</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># unique value of "Type 1"</span></span><br><span class="line">df[<span class="string">'Type 1'</span>].unique()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array(['Grass', 'Fire', 'Water', 'Bug', 'Normal', 'Poison', 'Electric',
       'Ground', 'Fairy', 'Fighting', 'Psychic', 'Rock', 'Ghost', 'Ice',
       'Dragon', 'Dark', 'Steel', 'Flying'], dtype=object)
</code></pre>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># No. of unique value for "Type 1"</span></span><br><span class="line">len(df[<span class="string">'Type 1'</span>].unique())</span><br></pre></td></tr></tbody></table></figure>
<pre><code>18
</code></pre>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># unique value of "Type 2"  (exclude "NaN")</span></span><br><span class="line">df[df[<span class="string">'Type 2'</span>].notnull()][<span class="string">'Type 2'</span>].unique()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array(['Poison', 'Flying', 'Dragon', 'Ground', 'Fairy', 'Grass',
       'Fighting', 'Psychic', 'Steel', 'Ice', 'Rock', 'Dark', 'Water',
       'Electric', 'Fire', 'Ghost', 'Bug', 'Normal'], dtype=object)
</code></pre>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># No. of unique value for "Type 2"</span></span><br><span class="line">len(df[df[<span class="string">'Type 2'</span>].notnull()][<span class="string">'Type 2'</span>].unique())</span><br></pre></td></tr></tbody></table></figure>
<pre><code>18
</code></pre>
  <br>
<h3 id="2-2-변수feature-특징-탐색"><a class="markdownIt-Anchor" href="#2-2-변수feature-특징-탐색"></a> 2-2. 변수(Feature) 특징 탐색</h3>
<p>각 변수(Feature)의 분포를 관찰함으로써, 변수들의 특징을 알아보도록 하겠습니다.</p>
<p>특히, 저희가 분류할 목표 Feature가 "Legendary"이므로, 각 변수의 분포를 탐색 시:</p>
<ol>
<li>각 항목(feature)에서 <strong>전체 데이터의 분포</strong> 뿐만 아닌</li>
<li><strong>"Legendary"변수 class 별의 데이터 분포</strong>도 함께 살펴볼게요.</li>
</ol>
   <br> 
<p><strong>GUIDE</strong></p>
<p>【전체 데이터 탐색】  <strong>&amp;</strong>  【“Legendary” class별 탐색】</p>
<ol>
<li>각 능력치 분포</li>
<li>총 능력치 (Toal) 분포</li>
<li>포켓몬 타입 (Type 1 &amp; Type 2) 분포</li>
<li>포켓몬 세대 (Generation) 분포</li>
</ol>
 <br> 
<h4 id="1-각-능력치-분포"><a class="markdownIt-Anchor" href="#1-각-능력치-분포"></a> (1) 각 능력치 분포</h4>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 전체 포켓몬의 각 능력치 분포</span></span><br><span class="line"></span><br><span class="line">stats = [<span class="string">'HP'</span>, <span class="string">'Attack'</span>, <span class="string">'Defense'</span>, <span class="string">'Sp. Atk'</span>, <span class="string">'Sp. Def'</span>, <span class="string">'Speed'</span>] <span class="comment"># 능력치 변수 집합</span></span><br><span class="line">sns.boxplot(data = df[stats])</span><br><span class="line">plt.title(<span class="string">'각 능력치 분포'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/images/E-Python-Classification-1/output_48_0.png" alt="output_48_0"></p>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># "전설의 포켓몬" 여부에 따른 능력치 분포</span></span><br><span class="line"></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">16</span>, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">sns.boxplot(data = df[df[<span class="string">'Legendary'</span>]==<span class="number">1</span>][stats])</span><br><span class="line">plt.title(<span class="string">'Legendary = True'</span>)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">sns.boxplot(data = df[df[<span class="string">'Legendary'</span>]==<span class="number">0</span>][stats])</span><br><span class="line">plt.title(<span class="string">'Legendary = False'</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/images/E-Python-Classification-1/output_50_0.png" alt="output_50_0"></p>
 <br>
<p>"전설의 포켓몬"은 전체적으로 더 높은 능력치를 보유하고 있으며, Attack와 Sp.Atk가 특히 높은 것으로 보입니다.</p>
 <br> 
<h4 id="2-총-능력치-total-분포"><a class="markdownIt-Anchor" href="#2-총-능력치-total-분포"></a> (2) 총 능력치 (Total) 분포</h4>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 전체 포켓몬의 총 능력치 분포</span></span><br><span class="line"></span><br><span class="line">df[<span class="string">'Total'</span>].hist(bins=<span class="number">50</span>)</span><br><span class="line">plt.title(<span class="string">'총 능력치 (Total) 분포'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/images/E-Python-Classification-1/output_54_0.png" alt="output_54_0"></p>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 세대별 총 능력치 분포</span></span><br><span class="line">sns.boxplot(data = df, x = <span class="string">"Generation"</span>, y=<span class="string">"Total"</span>)</span><br><span class="line">plt.title(<span class="string">"세대별 총 능력치 분포"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/images/E-Python-Classification-1/output_56_0.png" alt="output_56_0"></p>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 각 세대 "전설의 포켓몬" 여부에 따른 총 능력치 분포</span></span><br><span class="line">sns.boxplot(data = df, x = <span class="string">"Generation"</span>, y=<span class="string">"Total"</span>, hue=<span class="string">"Legendary"</span>)</span><br><span class="line">plt.title(<span class="string">"각 세대 '전설의 포켓몬' 여부에 따른 총 능력치 분포"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/images/E-Python-Classification-1/output_57_0.png" alt="output_57_0"></p>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 타입(Type 1)별 총 능력치 분포</span></span><br><span class="line">sns.boxplot(data = df, x = <span class="string">'Type 1'</span>, y = <span class="string">'Total'</span>)</span><br><span class="line">plt.title(<span class="string">"타입(Type 1)별 총 능력치 분포"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/images/E-Python-Classification-1/output_59_0.png" alt="output_59_0"></p>
<br>
<h4 id="3-포켓몬-타입-type-1-type-2-분포"><a class="markdownIt-Anchor" href="#3-포켓몬-타입-type-1-type-2-분포"></a> (3) 포켓몬 타입 (Type 1 &amp; Type 2) 분포</h4>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 전체 포켓몬 -- Type 1 분포</span></span><br><span class="line"></span><br><span class="line">df[<span class="string">'Type 1'</span>].value_counts(sort=<span class="literal">False</span>).sort_index().plot.barh()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x2e92fab51c8&gt;
</code></pre>
<p><img src="/images/E-Python-Classification-1/output_62_1.png" alt="output_62_1"></p>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># "전설의 포켓몬" 여부에 따른 Type 1 분포</span></span><br><span class="line"></span><br><span class="line">T1_Total = pd.DataFrame(df[<span class="string">'Type 1'</span>].value_counts().sort_index())</span><br><span class="line">T1_NotLeg = pd.DataFrame(df[df[<span class="string">'Legendary'</span>]==<span class="number">0</span>].groupby(<span class="string">'Type 1'</span>).size())</span><br><span class="line">T1_count = pd.concat([T1_Total, T1_NotLeg], axis = <span class="number">1</span>)</span><br><span class="line">T1_count.columns = [<span class="string">'Total'</span>, <span class="string">'Not Legend'</span>]</span><br><span class="line">T1_count[<span class="string">'Legend'</span>] = T1_count[<span class="string">'Total'</span>] - T1_count[<span class="string">'Not Legend'</span>]</span><br><span class="line">T1_count</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table>
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total</th>
      <th>Not Legend</th>
      <th>Legend</th>
    </tr>
    <tr>
      <th>Type 1</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bug</th>
      <td>69</td>
      <td>69</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Dark</th>
      <td>31</td>
      <td>29</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Dragon</th>
      <td>32</td>
      <td>20</td>
      <td>12</td>
    </tr>
    <tr>
      <th>Electric</th>
      <td>44</td>
      <td>40</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Fairy</th>
      <td>17</td>
      <td>16</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Fighting</th>
      <td>27</td>
      <td>27</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Fire</th>
      <td>52</td>
      <td>47</td>
      <td>5</td>
    </tr>
    <tr>
      <th>Flying</th>
      <td>4</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Ghost</th>
      <td>32</td>
      <td>30</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Grass</th>
      <td>70</td>
      <td>67</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Ground</th>
      <td>32</td>
      <td>28</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Ice</th>
      <td>24</td>
      <td>22</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Normal</th>
      <td>98</td>
      <td>96</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Poison</th>
      <td>28</td>
      <td>28</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Psychic</th>
      <td>57</td>
      <td>43</td>
      <td>14</td>
    </tr>
    <tr>
      <th>Rock</th>
      <td>44</td>
      <td>40</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Steel</th>
      <td>27</td>
      <td>23</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Water</th>
      <td>112</td>
      <td>108</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">T1_count[[<span class="string">'Not Legend'</span>, <span class="string">'Legend'</span>]].plot.barh(width=<span class="number">0.7</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x2e92ff18b88&gt;
</code></pre>
<p><img src="/images/E-Python-Classification-1/output_65_1.png" alt="output_65_1"></p>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 전체 포켓몬 -- Type 2 분포</span></span><br><span class="line"></span><br><span class="line">df[<span class="string">'Type 2'</span>].value_counts(sort=<span class="literal">False</span>).sort_index().plot.barh()</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">'"전설의 포켓몬" 여부에 따른 Type 1 분포'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/images/E-Python-Classification-1/output_67_0.png" alt="output_67_0"></p>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># "전설의 포켓몬" 여부에 따른 Type 2 분포</span></span><br><span class="line"></span><br><span class="line">T2_Total = pd.DataFrame(df[<span class="string">'Type 2'</span>].value_counts().sort_index())</span><br><span class="line">T2_NotLeg = pd.DataFrame(df[df[<span class="string">'Legendary'</span>]==<span class="number">0</span>].groupby(<span class="string">'Type 2'</span>).size())</span><br><span class="line">T2_count = pd.concat([T2_Total, T2_NotLeg], axis = <span class="number">1</span>)</span><br><span class="line">T2_count.columns = [<span class="string">'Total'</span>, <span class="string">'Not Legend'</span>]</span><br><span class="line">T2_count[<span class="string">'Legend'</span>] = T2_count[<span class="string">'Total'</span>] - T2_count[<span class="string">'Not Legend'</span>]</span><br><span class="line">T2_count</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table>
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total</th>
      <th>Not Legend</th>
      <th>Legend</th>
    </tr>
    <tr>
      <th>Type 2</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bug</th>
      <td>3</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Dark</th>
      <td>20</td>
      <td>19</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Dragon</th>
      <td>18</td>
      <td>14</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Electric</th>
      <td>6</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Fairy</th>
      <td>23</td>
      <td>21</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Fighting</th>
      <td>26</td>
      <td>22</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Fire</th>
      <td>12</td>
      <td>9</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Flying</th>
      <td>97</td>
      <td>84</td>
      <td>13</td>
    </tr>
    <tr>
      <th>Ghost</th>
      <td>14</td>
      <td>13</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Grass</th>
      <td>25</td>
      <td>25</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Ground</th>
      <td>35</td>
      <td>34</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Ice</th>
      <td>14</td>
      <td>11</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Normal</th>
      <td>4</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Poison</th>
      <td>34</td>
      <td>34</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Psychic</th>
      <td>33</td>
      <td>28</td>
      <td>5</td>
    </tr>
    <tr>
      <th>Rock</th>
      <td>14</td>
      <td>14</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Steel</th>
      <td>22</td>
      <td>21</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Water</th>
      <td>14</td>
      <td>13</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">T2_count[[<span class="string">'Not Legend'</span>, <span class="string">'Legend'</span>]].plot.barh(width=<span class="number">0.7</span>)</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">'"전설의 포켓몬" 여부에 따른 Type 2 분포'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/images/E-Python-Classification-1/output_70_0.png" alt="output_70_0"></p>
<br>
<h4 id="4-포켓몬-세대generation-분포"><a class="markdownIt-Anchor" href="#4-포켓몬-세대generation-분포"></a> (4) 포켓몬 세대(Generation) 분포</h4>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 전체 포켓몬 -- 세대 분포</span></span><br><span class="line"></span><br><span class="line">df[<span class="string">'Generation'</span>].value_counts().sort_index().plot.bar()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x2e930887d08&gt;
</code></pre>
<p><img src="/images/E-Python-Classification-1/output_73_1.png" alt="output_73_1"></p>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># "전설의 포켓몬" 여부에 따른 세대 분포</span></span><br><span class="line"></span><br><span class="line">gene_Leg = pd.DataFrame(df[df[<span class="string">'Legendary'</span>]==<span class="number">1</span>].groupby(<span class="string">'Generation'</span>).size())</span><br><span class="line">gene_NotLeg = pd.DataFrame(df[df[<span class="string">'Legendary'</span>]==<span class="number">0</span>].groupby(<span class="string">'Generation'</span>).size())</span><br><span class="line">gene_count = pd.concat([gene_Leg, gene_NotLeg], axis=<span class="number">1</span>)</span><br><span class="line">gene_count.columns = [<span class="string">'Legend'</span>, <span class="string">'Not Legend'</span>]</span><br><span class="line">gene_count</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table>
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Legend</th>
      <th>Not Legend</th>
    </tr>
    <tr>
      <th>Generation</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>6</td>
      <td>160</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>101</td>
    </tr>
    <tr>
      <th>3</th>
      <td>18</td>
      <td>142</td>
    </tr>
    <tr>
      <th>4</th>
      <td>13</td>
      <td>108</td>
    </tr>
    <tr>
      <th>5</th>
      <td>15</td>
      <td>150</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8</td>
      <td>74</td>
    </tr>
  </tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gene_count.plot.bar()</span><br><span class="line">plt.title(<span class="string">'"전설의 포켓몬" 여부에 따른 세대 분포'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/images/E-Python-Classification-1/output_76_0.png" alt="output_76_0"></p>
<br>
<br>
<h2 id="3-지도-학습-기반-분류-분석-logistic-regression"><a class="markdownIt-Anchor" href="#3-지도-학습-기반-분류-분석-logistic-regression"></a> <strong>3. 지도 학습 기반 분류 분석 – Logistic Regression</strong></h2>
<h3 id="3-1-데이터-전처리"><a class="markdownIt-Anchor" href="#3-1-데이터-전처리"></a> 3-1. 데이터 전처리</h3>
<h4 id="1-데이터-타입-변경"><a class="markdownIt-Anchor" href="#1-데이터-타입-변경"></a> (1) 데이터 타입 변경</h4>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.head()</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table>
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>#</th>
      <th>Name</th>
      <th>Type 1</th>
      <th>Type 2</th>
      <th>Total</th>
      <th>HP</th>
      <th>Attack</th>
      <th>Defense</th>
      <th>Sp. Atk</th>
      <th>Sp. Def</th>
      <th>Speed</th>
      <th>Generation</th>
      <th>Legendary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Bulbasaur</td>
      <td>Grass</td>
      <td>Poison</td>
      <td>318</td>
      <td>45</td>
      <td>49</td>
      <td>49</td>
      <td>65</td>
      <td>65</td>
      <td>45</td>
      <td>1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Ivysaur</td>
      <td>Grass</td>
      <td>Poison</td>
      <td>405</td>
      <td>60</td>
      <td>62</td>
      <td>63</td>
      <td>80</td>
      <td>80</td>
      <td>60</td>
      <td>1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Venusaur</td>
      <td>Grass</td>
      <td>Poison</td>
      <td>525</td>
      <td>80</td>
      <td>82</td>
      <td>83</td>
      <td>100</td>
      <td>100</td>
      <td>80</td>
      <td>1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>VenusaurMega Venusaur</td>
      <td>Grass</td>
      <td>Poison</td>
      <td>625</td>
      <td>80</td>
      <td>100</td>
      <td>123</td>
      <td>122</td>
      <td>120</td>
      <td>80</td>
      <td>1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Charmander</td>
      <td>Fire</td>
      <td>NaN</td>
      <td>309</td>
      <td>39</td>
      <td>52</td>
      <td>43</td>
      <td>60</td>
      <td>50</td>
      <td>65</td>
      <td>1</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.info()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 800 entries, 0 to 799
Data columns (total 13 columns):
 #   Column      Non-Null Count  Dtype 
---  ------      --------------  ----- 
 0   #           800 non-null    int64 
 1   Name        800 non-null    object
 2   Type 1      800 non-null    object
 3   Type 2      414 non-null    object
 4   Total       800 non-null    int64 
 5   HP          800 non-null    int64 
 6   Attack      800 non-null    int64 
 7   Defense     800 non-null    int64 
 8   Sp. Atk     800 non-null    int64 
 9   Sp. Def     800 non-null    int64 
 10  Speed       800 non-null    int64 
 11  Generation  800 non-null    int64 
 12  Legendary   800 non-null    bool  
dtypes: bool(1), int64(9), object(3)
memory usage: 75.9+ KB
</code></pre>
<br>
<ul>
<li>
<p>분류예측 목표 Feature인 "Lengendary"의 값은 현재 “True”/"False"로 구성되어있습니다. 예측 모델에 적용하기 위해 “1”/"0"으로 바꾸겠습니다.</p>
</li>
<li>
<p>포켓몬의 세대를 나타나는 Feature인 "Generation"의 타입은 지금 "int"로 되어있지만, Feature의 의미상 해당 숫자는 분류 역할을 하고 있으므로 "str"타입으로 변환시키겠습니다.</p>
</li>
<li>
<p>분류 예측 시 이름 데이터가 예측에 도움이 없으므로 "Name"을 빼고 데이터셋을 제구성하겠습니다.</p>
<br>
</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'Legendary'</span>] = df[<span class="string">'Legendary'</span>].astype(int)</span><br><span class="line">df[<span class="string">'Generation'</span>] = df[<span class="string">'Generation'</span>].astype(str)</span><br><span class="line">preprocessed_df = df[[<span class="string">'Type 1'</span>, <span class="string">'Type 2'</span>, <span class="string">'Total'</span>, <span class="string">'HP'</span>, <span class="string">'Attack'</span>, <span class="string">'Defense'</span>, </span><br><span class="line">                      <span class="string">'Sp. Atk'</span>, <span class="string">'Sp. Def'</span>, <span class="string">'Speed'</span>, <span class="string">'Generation'</span>, <span class="string">'Legendary'</span>]]</span><br><span class="line">preprocessed_df.head()</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table>
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Type 1</th>
      <th>Type 2</th>
      <th>Total</th>
      <th>HP</th>
      <th>Attack</th>
      <th>Defense</th>
      <th>Sp. Atk</th>
      <th>Sp. Def</th>
      <th>Speed</th>
      <th>Generation</th>
      <th>Legendary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Grass</td>
      <td>Poison</td>
      <td>318</td>
      <td>45</td>
      <td>49</td>
      <td>49</td>
      <td>65</td>
      <td>65</td>
      <td>45</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Grass</td>
      <td>Poison</td>
      <td>405</td>
      <td>60</td>
      <td>62</td>
      <td>63</td>
      <td>80</td>
      <td>80</td>
      <td>60</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Grass</td>
      <td>Poison</td>
      <td>525</td>
      <td>80</td>
      <td>82</td>
      <td>83</td>
      <td>100</td>
      <td>100</td>
      <td>80</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Grass</td>
      <td>Poison</td>
      <td>625</td>
      <td>80</td>
      <td>100</td>
      <td>123</td>
      <td>122</td>
      <td>120</td>
      <td>80</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Fire</td>
      <td>NaN</td>
      <td>309</td>
      <td>39</td>
      <td>52</td>
      <td>43</td>
      <td>60</td>
      <td>50</td>
      <td>65</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
<br>  
<h4 id="2-one-hot-encoding"><a class="markdownIt-Anchor" href="#2-one-hot-encoding"></a> (2) One-Hot Encoding</h4>
<p>Categorical Variable에 대해서 dummy화 작업을 진행하겠습니다.</p>
<ul>
<li>
<p>1 data one-label: One-hot Encoding</p>
</li>
<li>
<p>1 data multi-label: Multi-label Encoding</p>
<br>
</li>
</ul>
<p><strong>&gt;&gt; 타입 (Type) – Multi-label Encoding</strong></p>
<ul>
<li>먼저 Type 1과 Type 2를 하나의 변수(Type)로 묶는다.</li>
<li>그 다음 1~2개의 label를 가진 Type변수에 대해서 Multi-label Encoding을 진행한다.</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pokemon type list 생성</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_list</span><span class="params">(x1, x2)</span>:</span></span><br><span class="line">    type_list = []</span><br><span class="line">    type_list.append(x1)</span><br><span class="line">    <span class="keyword">if</span> x2 <span class="keyword">is</span> <span class="keyword">not</span> np.nan:</span><br><span class="line">        type_list.append(x2)</span><br><span class="line">    <span class="keyword">return</span> type_list</span><br><span class="line"></span><br><span class="line">preprocessed_df[<span class="string">'Type'</span>] = preprocessed_df.apply(<span class="keyword">lambda</span> x: make_list(x[<span class="string">'Type 1'</span>], x[<span class="string">'Type 2'</span>]), axis=<span class="number">1</span>)</span><br><span class="line">preprocessed_df.head()</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table>
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Type 1</th>
      <th>Type 2</th>
      <th>Total</th>
      <th>HP</th>
      <th>Attack</th>
      <th>Defense</th>
      <th>Sp. Atk</th>
      <th>Sp. Def</th>
      <th>Speed</th>
      <th>Generation</th>
      <th>Legendary</th>
      <th>Type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Grass</td>
      <td>Poison</td>
      <td>318</td>
      <td>45</td>
      <td>49</td>
      <td>49</td>
      <td>65</td>
      <td>65</td>
      <td>45</td>
      <td>1</td>
      <td>0</td>
      <td>[Grass, Poison]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Grass</td>
      <td>Poison</td>
      <td>405</td>
      <td>60</td>
      <td>62</td>
      <td>63</td>
      <td>80</td>
      <td>80</td>
      <td>60</td>
      <td>1</td>
      <td>0</td>
      <td>[Grass, Poison]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Grass</td>
      <td>Poison</td>
      <td>525</td>
      <td>80</td>
      <td>82</td>
      <td>83</td>
      <td>100</td>
      <td>100</td>
      <td>80</td>
      <td>1</td>
      <td>0</td>
      <td>[Grass, Poison]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Grass</td>
      <td>Poison</td>
      <td>625</td>
      <td>80</td>
      <td>100</td>
      <td>123</td>
      <td>122</td>
      <td>120</td>
      <td>80</td>
      <td>1</td>
      <td>0</td>
      <td>[Grass, Poison]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Fire</td>
      <td>NaN</td>
      <td>309</td>
      <td>39</td>
      <td>52</td>
      <td>43</td>
      <td>60</td>
      <td>50</td>
      <td>65</td>
      <td>1</td>
      <td>0</td>
      <td>[Fire]</td>
    </tr>
  </tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">del</span> preprocessed_df[<span class="string">'Type 1'</span>]</span><br><span class="line"><span class="keyword">del</span> preprocessed_df[<span class="string">'Type 2'</span>]</span><br><span class="line">preprocessed_df.head()</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table>
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total</th>
      <th>HP</th>
      <th>Attack</th>
      <th>Defense</th>
      <th>Sp. Atk</th>
      <th>Sp. Def</th>
      <th>Speed</th>
      <th>Generation</th>
      <th>Legendary</th>
      <th>Type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>318</td>
      <td>45</td>
      <td>49</td>
      <td>49</td>
      <td>65</td>
      <td>65</td>
      <td>45</td>
      <td>1</td>
      <td>0</td>
      <td>[Grass, Poison]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>405</td>
      <td>60</td>
      <td>62</td>
      <td>63</td>
      <td>80</td>
      <td>80</td>
      <td>60</td>
      <td>1</td>
      <td>0</td>
      <td>[Grass, Poison]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>525</td>
      <td>80</td>
      <td>82</td>
      <td>83</td>
      <td>100</td>
      <td>100</td>
      <td>80</td>
      <td>1</td>
      <td>0</td>
      <td>[Grass, Poison]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>625</td>
      <td>80</td>
      <td>100</td>
      <td>123</td>
      <td>122</td>
      <td>120</td>
      <td>80</td>
      <td>1</td>
      <td>0</td>
      <td>[Grass, Poison]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>309</td>
      <td>39</td>
      <td>52</td>
      <td>43</td>
      <td>60</td>
      <td>50</td>
      <td>65</td>
      <td>1</td>
      <td>0</td>
      <td>[Fire]</td>
    </tr>
  </tbody>
</table>
</div>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># multi-lacel encoding</span></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> MultiLabelBinarizer</span><br><span class="line"></span><br><span class="line">ml = MultiLabelBinarizer()</span><br><span class="line">preprocessed_df = preprocessed_df.join(pd.DataFrame(ml.fit_transform(preprocessed_df.pop(<span class="string">'Type'</span>)),</span><br><span class="line">                                                    columns = ml.classes_))</span><br></pre></td></tr></tbody></table></figure>
<blockquote>
<ul>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.join.html" target="_blank" rel="noopener">[pandas.DataFrame.join]</a>: Join columns of another DataFrame</li>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.pop.html" target="_blank" rel="noopener">[pandas.DataFrame.pop (<em>item</em>) ]</a>: Return item and drop from frame</li>
</ul>
</blockquote>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preprocessed_df.head()</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<div style="overflow:auto">
<table>
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total</th>
      <th>HP</th>
      <th>Attack</th>
      <th>Defense</th>
      <th>Sp. Atk</th>
      <th>Sp. Def</th>
      <th>Speed</th>
      <th>Generation</th>
      <th>Legendary</th>
      <th>Bug</th>
      <th>...</th>
      <th>Ghost</th>
      <th>Grass</th>
      <th>Ground</th>
      <th>Ice</th>
      <th>Normal</th>
      <th>Poison</th>
      <th>Psychic</th>
      <th>Rock</th>
      <th>Steel</th>
      <th>Water</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>318</td>
      <td>45</td>
      <td>49</td>
      <td>49</td>
      <td>65</td>
      <td>65</td>
      <td>45</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>405</td>
      <td>60</td>
      <td>62</td>
      <td>63</td>
      <td>80</td>
      <td>80</td>
      <td>60</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>525</td>
      <td>80</td>
      <td>82</td>
      <td>83</td>
      <td>100</td>
      <td>100</td>
      <td>80</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>625</td>
      <td>80</td>
      <td>100</td>
      <td>123</td>
      <td>122</td>
      <td>120</td>
      <td>80</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>309</td>
      <td>39</td>
      <td>52</td>
      <td>43</td>
      <td>60</td>
      <td>50</td>
      <td>65</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 27 columns</p>
</div>
</div>
 <br> 
<p><strong>&gt;&gt; 세대 (Generation) – One-hot Encoding</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># apply one-hot encoding to 'Generation'</span></span><br><span class="line">preprocessed_df = pd.get_dummies(preprocessed_df)  <span class="comment"># df name입력하면 str var를 자동 식별하여 encoding 진행함</span></span><br><span class="line"><span class="comment"># preprocessed_ddf = pd.get_dummies(preprocessed_df['Generation'])  # 작업할 var 지정</span></span><br><span class="line">preprocessed_df.head()</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<div style="overflow:auto">
<table>
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total</th>
      <th>HP</th>
      <th>Attack</th>
      <th>Defense</th>
      <th>Sp. Atk</th>
      <th>Sp. Def</th>
      <th>Speed</th>
      <th>Legendary</th>
      <th>Bug</th>
      <th>Dark</th>
      <th>...</th>
      <th>Psychic</th>
      <th>Rock</th>
      <th>Steel</th>
      <th>Water</th>
      <th>Generation_1</th>
      <th>Generation_2</th>
      <th>Generation_3</th>
      <th>Generation_4</th>
      <th>Generation_5</th>
      <th>Generation_6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>318</td>
      <td>45</td>
      <td>49</td>
      <td>49</td>
      <td>65</td>
      <td>65</td>
      <td>45</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>405</td>
      <td>60</td>
      <td>62</td>
      <td>63</td>
      <td>80</td>
      <td>80</td>
      <td>60</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>525</td>
      <td>80</td>
      <td>82</td>
      <td>83</td>
      <td>100</td>
      <td>100</td>
      <td>80</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>625</td>
      <td>80</td>
      <td>100</td>
      <td>123</td>
      <td>122</td>
      <td>120</td>
      <td>80</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>309</td>
      <td>39</td>
      <td>52</td>
      <td>43</td>
      <td>60</td>
      <td>50</td>
      <td>65</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 32 columns</p>
</div>
</div>
<br>  
<h4 id="3-feature-포준화"><a class="markdownIt-Anchor" href="#3-feature-포준화"></a> (3) Feature 포준화</h4>
<p>Numerical Feature간의 Scale차이를 없애기 위해 feature 표준화를 진행합니다.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preprocessed_df.info()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 800 entries, 0 to 799
Data columns (total 32 columns):
 #   Column        Non-Null Count  Dtype
---  ------        --------------  -----
 0   Total         800 non-null    int64
 1   HP            800 non-null    int64
 2   Attack        800 non-null    int64
 3   Defense       800 non-null    int64
 4   Sp. Atk       800 non-null    int64
 5   Sp. Def       800 non-null    int64
 6   Speed         800 non-null    int64
 7   Legendary     800 non-null    int32
 8   Bug           800 non-null    int32
 9   Dark          800 non-null    int32
 10  Dragon        800 non-null    int32
 11  Electric      800 non-null    int32
 12  Fairy         800 non-null    int32
 13  Fighting      800 non-null    int32
 14  Fire          800 non-null    int32
 15  Flying        800 non-null    int32
 16  Ghost         800 non-null    int32
 17  Grass         800 non-null    int32
 18  Ground        800 non-null    int32
 19  Ice           800 non-null    int32
 20  Normal        800 non-null    int32
 21  Poison        800 non-null    int32
 22  Psychic       800 non-null    int32
 23  Rock          800 non-null    int32
 24  Steel         800 non-null    int32
 25  Water         800 non-null    int32
 26  Generation_1  800 non-null    uint8
 27  Generation_2  800 non-null    uint8
 28  Generation_3  800 non-null    uint8
 29  Generation_4  800 non-null    uint8
 30  Generation_5  800 non-null    uint8
 31  Generation_6  800 non-null    uint8
dtypes: int32(19), int64(7), uint8(6)
memory usage: 107.9 KB
</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"></span><br><span class="line"><span class="comment"># feature standardization</span></span><br><span class="line">scaler = StandardScaler()</span><br><span class="line">scale_columns = [<span class="string">'Total'</span>, <span class="string">'HP'</span>, <span class="string">'Attack'</span>, <span class="string">'Defense'</span>, <span class="string">'Sp. Atk'</span>, <span class="string">'Sp. Def'</span>, <span class="string">'Speed'</span>]</span><br><span class="line">preprocessed_df[scale_columns] = scaler.fit_transform(preprocessed_df[scale_columns])</span><br><span class="line">preprocessed_df.head()</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<div style="overflow:auto">
<table>
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total</th>
      <th>HP</th>
      <th>Attack</th>
      <th>Defense</th>
      <th>Sp. Atk</th>
      <th>Sp. Def</th>
      <th>Speed</th>
      <th>Legendary</th>
      <th>Bug</th>
      <th>Dark</th>
      <th>...</th>
      <th>Psychic</th>
      <th>Rock</th>
      <th>Steel</th>
      <th>Water</th>
      <th>Generation_1</th>
      <th>Generation_2</th>
      <th>Generation_3</th>
      <th>Generation_4</th>
      <th>Generation_5</th>
      <th>Generation_6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.976765</td>
      <td>-0.950626</td>
      <td>-0.924906</td>
      <td>-0.797154</td>
      <td>-0.239130</td>
      <td>-0.248189</td>
      <td>-0.801503</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.251088</td>
      <td>-0.362822</td>
      <td>-0.524130</td>
      <td>-0.347917</td>
      <td>0.219560</td>
      <td>0.291156</td>
      <td>-0.285015</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.749845</td>
      <td>0.420917</td>
      <td>0.092448</td>
      <td>0.293849</td>
      <td>0.831146</td>
      <td>1.010283</td>
      <td>0.403635</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.583957</td>
      <td>0.420917</td>
      <td>0.647369</td>
      <td>1.577381</td>
      <td>1.503891</td>
      <td>1.729409</td>
      <td>0.403635</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.051836</td>
      <td>-1.185748</td>
      <td>-0.832419</td>
      <td>-0.989683</td>
      <td>-0.392027</td>
      <td>-0.787533</td>
      <td>-0.112853</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 32 columns</p>
</div>
</div>
 <br> 
<h4 id="4-training-set-test-set-나누기"><a class="markdownIt-Anchor" href="#4-training-set-test-set-나누기"></a> (4) Training set / Test set 나누기</h4>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"></span><br><span class="line">X = preprocessed_df.loc[:, preprocessed_df.columns != <span class="string">'Legendary'</span>]</span><br><span class="line">y = preprocessed_df[<span class="string">'Legendary'</span>]</span><br><span class="line">x_train, x_test, y_train, y_test = train_test_split(X, y, test_size=<span class="number">0.25</span>, random_state=<span class="number">1</span>)</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x_train.shape, y_train.shape</span><br></pre></td></tr></tbody></table></figure>
<pre><code>((600, 31), (600,))
</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x_test.shape, y_test.shape</span><br></pre></td></tr></tbody></table></figure>
<pre><code>((200, 31), (200,))
</code></pre>
 <br> 
<h3 id="3-2-logistic-regression-모델-학습"><a class="markdownIt-Anchor" href="#3-2-logistic-regression-모델-학습"></a> 3-2. Logistic Regression 모델 학습</h3>
<h4 id="1-모델-학습"><a class="markdownIt-Anchor" href="#1-모델-학습"></a> (1) 모델 학습</h4>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, precision_score, recall_score, f1_score</span><br><span class="line"></span><br><span class="line"><span class="comment"># Fit in Training set</span></span><br><span class="line">logit = LogisticRegression(random_state=<span class="number">0</span>)</span><br><span class="line">logit.fit(x_train, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Predict in Test set</span></span><br><span class="line">y_pred = logit.predict(x_test)</span><br></pre></td></tr></tbody></table></figure>
  <br>
<h4 id="2-모델-평가"><a class="markdownIt-Anchor" href="#2-모델-평가"></a> (2) 모델 평가</h4>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># classification result for test set</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">"accuracy: %.2f"</span> % accuracy_score(y_test, y_pred))</span><br><span class="line">print(<span class="string">"Precision: %.3f"</span> % precision_score(y_test, y_pred))</span><br><span class="line">print(<span class="string">"Recall: %.3f"</span> % recall_score(y_test, y_pred))</span><br><span class="line">print(<span class="string">"F1: %.3f"</span> % f1_score(y_test, y_pred))</span><br></pre></td></tr></tbody></table></figure>
<pre><code>accuracy: 0.93
Precision: 0.615
Recall: 0.471
F1: 0.533
</code></pre>
<br>
<p>위 모델 평가 결과를 확인해보면, 해당 모델은 <strong>정확도(accuracy) 만</strong> 높고, 정밀도(Precision), 재현율(Recall), F1 score 등 모두 낮습니다. 이는 학습 데이터의 <strong>클래스 불균형으로 인한 정확도 함정</strong> 문제일 가능성이 높습니다. (참고: <a href="https://hyemin-kim.github.io/2020/07/26/S-Python-sklearn2/#4-2-%EC%A0%95%ED%99%95%EB%8F%84-accuracy">[Python &gt;&gt; sklearn - (2) 분류] 4-2. !!정확도 함정!!</a>)</p>
<p>추가 확인을 위해 Confusion Matrix를 출력해 봅니다.</p>
  <br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.set_printoptions(suppress=<span class="literal">True</span>)</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> confusion_matrix</span><br><span class="line"></span><br><span class="line"><span class="comment"># print confusion matrix</span></span><br><span class="line">confu = confusion_matrix(y_true = y_test, y_pred = y_pred)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">4</span>, <span class="number">3</span>))</span><br><span class="line">sns.heatmap(confu, annot=<span class="literal">True</span>, annot_kws={<span class="string">'size'</span>:<span class="number">15</span>}, cmap=<span class="string">'OrRd'</span>, fmt=<span class="string">'.10g'</span>)</span><br><span class="line">plt.title(<span class="string">'Confusion Matrix'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/images/E-Python-Classification-1/output_122_0.png" alt="output_122_0"></p>
<p>Positive Condition ( <em>“Legendary” = True/1</em> ) &lt;17&gt; 대비 Negative Condition ( <em>“Legendary” = False/0</em> ) &lt;183&gt;인 케이스가 훨씬 많다는 것을 볼 수 있습니다. 따라서, 클래스 불균형으로 인한 정확도 함정 문제가 맞으며, <strong>클래스 불균형을 조정</strong>한 후 다시 학습 시키도록 하겠습니다.</p>
<br>  
<h3 id="3-3-클래스-불균형-조정"><a class="markdownIt-Anchor" href="#3-3-클래스-불균형-조정"></a> 3-3. 클래스 불균형 조정</h3>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preprocessed_df[<span class="string">'Legendary'</span>].value_counts()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>0    735
1     65
Name: Legendary, dtype: int64
</code></pre>
<br>  
<p><strong>&gt;&gt; 1:1 샘플링</strong></p>
<p>Positive Condition 케이스와 Negative Condition 케이스를 1:1비율로 샘플링 합니다.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">positive_random_idx = preprocessed_df[preprocessed_df[<span class="string">'Legendary'</span>]==<span class="number">1</span>].sample(<span class="number">65</span>, random_state=<span class="number">12</span>).index.tolist()</span><br><span class="line">negative_random_idx = preprocessed_df[preprocessed_df[<span class="string">'Legendary'</span>]==<span class="number">0</span>].sample(<span class="number">65</span>, random_state=<span class="number">12</span>).index.tolist()</span><br></pre></td></tr></tbody></table></figure>
  <br>
<p><strong>&gt;&gt; Training set / Test set 나누기</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">random_idx = positive_random_idx + negative_random_idx</span><br><span class="line">X = preprocessed_df.loc[random_idx, preprocessed_df.columns != <span class="string">'Legendary'</span>]</span><br><span class="line">y = preprocessed_df[<span class="string">'Legendary'</span>][random_idx]</span><br><span class="line">x_train, x_test, y_train, y_test = train_test_split(X, y, test_size=<span class="number">0.25</span>, random_state=<span class="number">1</span>)</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x_train.shape, y_train.shape</span><br></pre></td></tr></tbody></table></figure>
<pre><code>((97, 31), (97,))
</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x_test.shape, y_test.shape</span><br></pre></td></tr></tbody></table></figure>
<pre><code>((33, 31), (33,))
</code></pre>
<br>  
<p><strong>&gt;&gt; 모델 재학습</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Fit in Training set</span></span><br><span class="line">logit2 = LogisticRegression(random_state=<span class="number">0</span>)</span><br><span class="line">logit2.fit(x_train, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Predict in Test set</span></span><br><span class="line">y_pred2 = logit2.predict(x_test)</span><br></pre></td></tr></tbody></table></figure>
  <br>
<p><strong>&gt;&gt; 모델 재평가</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># clssification result for test set</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">"accuracy: %.2f"</span> % accuracy_score(y_test, y_pred2))</span><br><span class="line">print(<span class="string">"Precision: %.3f"</span> % precision_score(y_test, y_pred2))</span><br><span class="line">print(<span class="string">"Recall: %.3f"</span> % recall_score(y_test, y_pred2))</span><br><span class="line">print(<span class="string">"F1: %.3f"</span> % f1_score(y_test, y_pred2))</span><br></pre></td></tr></tbody></table></figure>
<pre><code>accuracy: 1.00
Precision: 1.000
Recall: 1.000
F1: 1.000
</code></pre>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># confusion matrix</span></span><br><span class="line"></span><br><span class="line">confu2 = confusion_matrix(y_true=y_test, y_pred = y_pred2)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">4</span>, <span class="number">3</span>))</span><br><span class="line">sns.heatmap(confu2, annot=<span class="literal">True</span>, annot_kws={<span class="string">'size'</span>:<span class="number">15</span>}, cmap=<span class="string">'OrRd'</span>, fmt=<span class="string">'.10g'</span>)</span><br><span class="line">plt.title(<span class="string">'Confusion Matrix'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/images/E-Python-Classification-1/output_143_0.png" alt="output_143_0"></p>
<p>클래스 불균형을 조정한 후, 새롭게 학습된 모델의 performance가 많이 좋아졌습니다.</p>
<p><br>  <br></p>
<h2 id="4-비지도-학습-기반-군집-분석-k-means-clustering"><a class="markdownIt-Anchor" href="#4-비지도-학습-기반-군집-분석-k-means-clustering"></a> <strong>4. 비지도 학습 기반 군집 분석 – K-Means Clustering</strong></h2>
<h3 id="4-1-k-means-군집-분석"><a class="markdownIt-Anchor" href="#4-1-k-means-군집-분석"></a> 4-1. K-Means 군집 분석</h3>
<h4 id="1-2차원-군집-분석"><a class="markdownIt-Anchor" href="#1-2차원-군집-분석"></a> (1) 2차원 군집 분석</h4>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.cluster <span class="keyword">import</span> KMeans</span><br><span class="line"></span><br><span class="line"><span class="comment"># K-means train &amp; Elbow method</span></span><br><span class="line">X = preprocessed_df[[<span class="string">'Attack'</span>, <span class="string">'Defense'</span>]]</span><br><span class="line"></span><br><span class="line">k_list = []</span><br><span class="line">cost_list = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range (<span class="number">1</span>, <span class="number">8</span>):</span><br><span class="line">    kmeans = KMeans(n_clusters=k).fit(X)</span><br><span class="line">    interia = kmeans.inertia_  <span class="comment"># inertia: Sum of squared distances of samples to their closest cluster center.</span></span><br><span class="line">    print(<span class="string">"k:"</span>, k, <span class="string">"| cost:"</span>, interia)</span><br><span class="line">    k_list.append(k)</span><br><span class="line">    cost_list.append(interia)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">8</span>, <span class="number">6</span>))</span><br><span class="line">plt.plot(k_list, cost_list)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>k: 1 | cost: 1600.0
k: 2 | cost: 853.3477298974242
k: 3 | cost: 642.3911470107209
k: 4 | cost: 480.49450250321513
k: 5 | cost: 403.97191765107124
k: 6 | cost: 343.98696660525184
k: 7 | cost: 295.56093457429847



[&lt;matplotlib.lines.Line2D at 0x2e930467c48&gt;]
</code></pre>
<p><img src="/images/E-Python-Classification-1/output_151_2.png" alt="output_151_2"></p>
<br>
<p>추세를 봤을 때, 4 clusters가 제일 적당한 것으로 보입니다.</p>
<p>따라서, cluster를 4로 지정한 후 다시 학습시킨 뒤, 각 데이터가 분류된 cluster 결과를 원 데이터셋에 추가합니다.</p>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># k-means fitting and predict</span></span><br><span class="line">kmeans = KMeans(n_clusters=<span class="number">4</span>).fit(X)</span><br><span class="line">cluster_num = pd.Series(kmeans.predict(X))</span><br><span class="line">preprocessed_df[<span class="string">'cluster_num'</span>] = cluster_num.values</span><br><span class="line">preprocessed_df.head()</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<div style="overflow:auto">
<table>
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total</th>
      <th>HP</th>
      <th>Attack</th>
      <th>Defense</th>
      <th>Sp. Atk</th>
      <th>Sp. Def</th>
      <th>Speed</th>
      <th>Legendary</th>
      <th>Bug</th>
      <th>Dark</th>
      <th>...</th>
      <th>Rock</th>
      <th>Steel</th>
      <th>Water</th>
      <th>Generation_1</th>
      <th>Generation_2</th>
      <th>Generation_3</th>
      <th>Generation_4</th>
      <th>Generation_5</th>
      <th>Generation_6</th>
      <th>cluster_num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.976765</td>
      <td>-0.950626</td>
      <td>-0.924906</td>
      <td>-0.797154</td>
      <td>-0.239130</td>
      <td>-0.248189</td>
      <td>-0.801503</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.251088</td>
      <td>-0.362822</td>
      <td>-0.524130</td>
      <td>-0.347917</td>
      <td>0.219560</td>
      <td>0.291156</td>
      <td>-0.285015</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.749845</td>
      <td>0.420917</td>
      <td>0.092448</td>
      <td>0.293849</td>
      <td>0.831146</td>
      <td>1.010283</td>
      <td>0.403635</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.583957</td>
      <td>0.420917</td>
      <td>0.647369</td>
      <td>1.577381</td>
      <td>1.503891</td>
      <td>1.729409</td>
      <td>0.403635</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.051836</td>
      <td>-1.185748</td>
      <td>-0.832419</td>
      <td>-0.989683</td>
      <td>-0.392027</td>
      <td>-0.787533</td>
      <td>-0.112853</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 33 columns</p>
</div>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(preprocessed_df[<span class="string">'cluster_num'</span>].value_counts())</span><br></pre></td></tr></tbody></table></figure>
<pre><code>2    309
0    253
3    128
1    110
Name: cluster_num, dtype: int64
</code></pre>
<br>
<p><strong>&gt;&gt; 군집 시각화</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Visualization</span></span><br><span class="line"></span><br><span class="line">plt.scatter(preprocessed_df[preprocessed_df[<span class="string">'cluster_num'</span>] == <span class="number">0</span>][<span class="string">'Attack'</span>],</span><br><span class="line">            preprocessed_df[preprocessed_df[<span class="string">'cluster_num'</span>] == <span class="number">0</span>][<span class="string">'Defense'</span>],</span><br><span class="line">            s = <span class="number">50</span>, c = <span class="string">'red'</span>, alpha = <span class="number">0.5</span>, label = <span class="string">'Pokemon Group 1'</span>)</span><br><span class="line">plt.scatter(preprocessed_df[preprocessed_df[<span class="string">'cluster_num'</span>] == <span class="number">1</span>][<span class="string">'Attack'</span>],</span><br><span class="line">            preprocessed_df[preprocessed_df[<span class="string">'cluster_num'</span>] == <span class="number">1</span>][<span class="string">'Defense'</span>],</span><br><span class="line">            s = <span class="number">50</span>, c = <span class="string">'green'</span>, alpha = <span class="number">0.7</span>, label = <span class="string">'Pokemon Group 2'</span>)</span><br><span class="line">plt.scatter(preprocessed_df[preprocessed_df[<span class="string">'cluster_num'</span>] == <span class="number">2</span>][<span class="string">'Attack'</span>],</span><br><span class="line">            preprocessed_df[preprocessed_df[<span class="string">'cluster_num'</span>] == <span class="number">2</span>][<span class="string">'Defense'</span>],</span><br><span class="line">            s = <span class="number">50</span>, c = <span class="string">'blue'</span>, alpha = <span class="number">0.5</span>, label = <span class="string">'Pokemon Group 3'</span>)</span><br><span class="line">plt.scatter(preprocessed_df[preprocessed_df[<span class="string">'cluster_num'</span>] == <span class="number">3</span>][<span class="string">'Attack'</span>],</span><br><span class="line">            preprocessed_df[preprocessed_df[<span class="string">'cluster_num'</span>] == <span class="number">3</span>][<span class="string">'Defense'</span>],</span><br><span class="line">            s = <span class="number">50</span>, c = <span class="string">'yellow'</span>, alpha = <span class="number">0.8</span>, label = <span class="string">'Pokemon Group 4'</span>)</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">'Pokemon Cluster by "Attack" &amp; "Defense"'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'Attack'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'Defense'</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/images/E-Python-Classification-1/output_157_0.png" alt="output_157_0"></p>
<br>
<h4 id="2-다차원-군집-분석"><a class="markdownIt-Anchor" href="#2-다차원-군집-분석"></a> (2) 다차원 군집 분석</h4>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.cluster <span class="keyword">import</span> KMeans</span><br><span class="line"></span><br><span class="line"><span class="comment"># K-Means train &amp; Elbow method</span></span><br><span class="line">X = preprocessed_df[[<span class="string">'HP'</span>, <span class="string">'Attack'</span>, <span class="string">'Defense'</span>, <span class="string">'Sp. Atk'</span>, <span class="string">'Sp. Def'</span>, <span class="string">'Speed'</span>]]</span><br><span class="line"></span><br><span class="line">k_list = []</span><br><span class="line">cost_list = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range (<span class="number">1</span>, <span class="number">15</span>):</span><br><span class="line">    kmeans = KMeans(n_clusters=k).fit(X)</span><br><span class="line">    interia = kmeans.inertia_  <span class="comment"># inertia: Sum of squared distances of samples to their closest cluster center.</span></span><br><span class="line">    print(<span class="string">"k:"</span>, k, <span class="string">"| cost:"</span>, interia)</span><br><span class="line">    k_list.append(k)</span><br><span class="line">    cost_list.append(interia)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">8</span>, <span class="number">6</span>))</span><br><span class="line">plt.plot(k_list, cost_list)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>k: 1 | cost: 4800.0
k: 2 | cost: 3275.3812330305977
k: 3 | cost: 2862.057922495397
k: 4 | cost: 2566.5807792995274
k: 5 | cost: 2328.0706840275643
k: 6 | cost: 2182.759972635841
k: 7 | cost: 2070.734327066247
k: 8 | cost: 1957.5240844927844
k: 9 | cost: 1854.3770148227836
k: 10 | cost: 1778.3178764912984
k: 11 | cost: 1721.845255688537
k: 12 | cost: 1644.3967658442484
k: 13 | cost: 1579.4938049394318
k: 14 | cost: 1536.785887021493



[&lt;matplotlib.lines.Line2D at 0x2e930efbb88&gt;]
</code></pre>
<p><img src="/images/E-Python-Classification-1/output_160_2.png" alt="output_160_2"></p>
<br>
<p>이 경우에는 cluster가 5일 때가 제일 적당해 보입니다.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># k-means fitting and predict</span></span><br><span class="line">kmeans = KMeans(n_clusters=<span class="number">5</span>).fit(X)</span><br><span class="line">cluster_num = pd.Series(kmeans.predict(X))</span><br><span class="line">preprocessed_df[<span class="string">'cluster_num'</span>] = cluster_num.values</span><br><span class="line">preprocessed_df.head()</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<div style="overflow:auto">
<table>
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total</th>
      <th>HP</th>
      <th>Attack</th>
      <th>Defense</th>
      <th>Sp. Atk</th>
      <th>Sp. Def</th>
      <th>Speed</th>
      <th>Legendary</th>
      <th>Bug</th>
      <th>Dark</th>
      <th>...</th>
      <th>Rock</th>
      <th>Steel</th>
      <th>Water</th>
      <th>Generation_1</th>
      <th>Generation_2</th>
      <th>Generation_3</th>
      <th>Generation_4</th>
      <th>Generation_5</th>
      <th>Generation_6</th>
      <th>cluster_num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.976765</td>
      <td>-0.950626</td>
      <td>-0.924906</td>
      <td>-0.797154</td>
      <td>-0.239130</td>
      <td>-0.248189</td>
      <td>-0.801503</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.251088</td>
      <td>-0.362822</td>
      <td>-0.524130</td>
      <td>-0.347917</td>
      <td>0.219560</td>
      <td>0.291156</td>
      <td>-0.285015</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.749845</td>
      <td>0.420917</td>
      <td>0.092448</td>
      <td>0.293849</td>
      <td>0.831146</td>
      <td>1.010283</td>
      <td>0.403635</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.583957</td>
      <td>0.420917</td>
      <td>0.647369</td>
      <td>1.577381</td>
      <td>1.503891</td>
      <td>1.729409</td>
      <td>0.403635</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.051836</td>
      <td>-1.185748</td>
      <td>-0.832419</td>
      <td>-0.989683</td>
      <td>-0.392027</td>
      <td>-0.787533</td>
      <td>-0.112853</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 33 columns</p>
</div>
</div>
<br>  
<p><strong>&gt;&gt; 군집별 특성 시각화</strong></p>
<p>2차원이 아니기 때문에 위와 같이 군집 결과를 시각화하기 어렵습니다.</p>
<p>군집화 결과를 확인하기 위해 <strong>각 Feature의 군집별 특성</strong>을 시각화하도록 하겠습니다.</p>
  <br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># HP</span></span><br><span class="line">sns.boxplot(x = <span class="string">"cluster_num"</span>, y = <span class="string">"HP"</span>, data = preprocessed_df)</span><br><span class="line">plt.title(<span class="string">'군집별 "HP" 분포'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/images/E-Python-Classification-1/output_167_0.png" alt="output_167_0"></p>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Attack</span></span><br><span class="line">sns.boxplot(x = <span class="string">'cluster_num'</span>, y = <span class="string">'Attack'</span>, data = preprocessed_df)</span><br><span class="line">plt.title(<span class="string">'군집별 "Attack" 분포'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/images/E-Python-Classification-1/output_169_0.png" alt="output_169_0"></p>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Defense</span></span><br><span class="line">sns.boxplot(x = <span class="string">'cluster_num'</span>, y = <span class="string">'Defense'</span>, data = preprocessed_df)</span><br><span class="line">plt.title(<span class="string">'군집별 "Defense" 분포'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/images/E-Python-Classification-1/output_171_0.png" alt="output_171_0"></p>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sp. Atk</span></span><br><span class="line">sns.boxplot(x = <span class="string">'cluster_num'</span>, y = <span class="string">'Sp. Atk'</span>, data = preprocessed_df)</span><br><span class="line">plt.title(<span class="string">'군집별 "Sp. Atk" 분포'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/images/E-Python-Classification-1/output_173_0.png" alt="output_173_0"></p>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sp. Def</span></span><br><span class="line">sns.boxplot(x = <span class="string">'cluster_num'</span>, y = <span class="string">'Sp. Def'</span>, data = preprocessed_df)</span><br><span class="line">plt.title(<span class="string">'군집별 "Sp. Def" 분포'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/images/E-Python-Classification-1/output_175_0.png" alt="output_175_0"></p>
<br>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Speed</span></span><br><span class="line">sns.boxplot(x = <span class="string">'cluster_num'</span>, y = <span class="string">'Speed'</span>, data = preprocessed_df)</span><br><span class="line">plt.title(<span class="string">'군집별 "Speed" 분포'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/images/E-Python-Classification-1/output_177_0.png" alt="output_177_0"></p>
<br>
<br><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Hyemin Kim</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://hyemin-kim.github.io/2020/08/13/E-Python-Classification-1/">https://hyemin-kim.github.io/2020/08/13/E-Python-Classification-1/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Python/">Python</a><a class="post-meta__tags" href="/tags/sklearn/">sklearn</a><a class="post-meta__tags" href="/tags/Machine-Learning/">Machine Learning</a><a class="post-meta__tags" href="/tags/%EB%B6%84%EB%A5%98/">분류</a></div><div class="post_share"><div class="social-share" data-image="https://s1.ax1x.com/2020/08/25/dcPqB9.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/08/19/S-Python-TextMining1/"><img class="prev-cover" src="https://s1.ax1x.com/2020/08/19/d1JMTS.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Python &gt;&gt; 텍스트 마이닝 (Text Mining) 소개</div></div></a></div><div class="next-post pull-right"><a href="/2020/08/11/E-Python-LinearRegression-1/"><img class="next-cover" src="https://s1.ax1x.com/2020/08/25/dciYCV.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">【실습】 Python &gt;&gt; EDA &amp; Linear Regression -- 부동산 가격 예측</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2020/07/26/S-Python-sklearn2/" title="Python >> sklearn - (2) 분류 (Classification)"><img class="cover" src="https://ohiing.com/wp-content/uploads/2020/02/scikit-learn-2.jpg"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-26</div><div class="title">Python >> sklearn - (2) 분류 (Classification)</div></div></a></div><div><a href="/2020/08/11/E-Python-LinearRegression-1/" title="【실습】 Python >> EDA & Linear Regression -- 부동산 가격 예측"><img class="cover" src="https://s1.ax1x.com/2020/08/25/dciYCV.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-11</div><div class="title">【실습】 Python >> EDA & Linear Regression -- 부동산 가격 예측</div></div></a></div><div><a href="/2020/07/17/S-Python-sklearn0/" title="Python >> sklearn -(0) sklearn 개요"><img class="cover" src="https://ohiing.com/wp-content/uploads/2020/02/scikit-learn-2.jpg"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-17</div><div class="title">Python >> sklearn -(0) sklearn 개요</div></div></a></div><div><a href="/2020/07/17/S-Python-sklearn1/" title="Python >> sklearn - (1) 전처리"><img class="cover" src="https://ohiing.com/wp-content/uploads/2020/02/scikit-learn-2.jpg"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-17</div><div class="title">Python >> sklearn - (1) 전처리</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></article></main><footer id="footer" style="background-image: url(https://s1.ax1x.com/2020/08/25/dcPqB9.png)"><div id="footer-wrap"><div class="copyright">&copy;2020 By Hyemin Kim</div><div class="framework-info"><span>Framework </span><a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener">Butterfly</a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> {preloader.endLoading()})</script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script>$(function () {
  $('span.katex-display').wrap('<div class="katex-wrap"></div>')
})</script><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk({
      clientID: 'ed00dae828f43e807ca1',
      clientSecret: '6127c1ef27fe0e15655c18f5ce3817472c83d2cd',
      repo: 'hyemin-Kim.github.io',
      owner: 'hyemin-Kim',
      admin: [''],
      id: '3b70bf58e6e6eda03b34ab887a479f12',
      language: 'en',
      perPage: 10,
      distractionFreeMode: false,
      pagerDirection: 'last',
      createIssueManually: false,
      updateCountCallback: commentCount
    })
    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    $.getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js', initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></body></html>